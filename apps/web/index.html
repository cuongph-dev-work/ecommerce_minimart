
  <!DOCTYPE html>
  <html lang="en">
    <head>
      <meta charset="UTF-8" />
      <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <meta name="theme-color" content="#2563eb" />
      <meta name="format-detection" content="telephone=no" />
      <title>Little Box</title>
      <meta name="description" content="" />
      <!-- <link rel="icon" type="image/svg+xml" href="/vite.svg" /> -->
      <script>
        // Preload settings for SEO - inject into window before React renders
        (function() {
          // Helper function to update favicon
          function updateFavicon(logoUrl) {
            // Remove existing favicon links
            const existingLinks = document.querySelectorAll('link[rel*="icon"]');
            existingLinks.forEach(link => link.remove());
            
            // Create new favicon link
            const link = document.createElement('link');
            link.rel = 'icon';
            link.type = 'image/png';
            link.href = logoUrl;
            document.head.appendChild(link);
            
            // Also add apple-touch-icon for better mobile support
            const appleLink = document.createElement('link');
            appleLink.rel = 'apple-touch-icon';
            appleLink.href = logoUrl;
            document.head.appendChild(appleLink);
          }
          
          // Helper function to update meta description
          function updateMetaDescription(description) {
            let metaDesc = document.querySelector('meta[name="description"]');
            if (!metaDesc) {
              metaDesc = document.createElement('meta');
              metaDesc.name = 'description';
              document.head.appendChild(metaDesc);
            }
            metaDesc.content = description;
          }
          
          // Get API URL from env config (injected by Vite plugin)
          const API_URL = (window.__ENV_CONFIG__ && window.__ENV_CONFIG__.VITE_API_URL) 
            || (window.location.origin.includes('localhost') ? 'http://localhost:8000/api' : '/api');
          const settingsKey = '__PRELOADED_SETTINGS__';
          
          // Try to load from localStorage first (cached, max 5 minutes)
          const cached = localStorage.getItem(settingsKey);
          const cachedTime = localStorage.getItem(settingsKey + '_timestamp');
          const fiveMinutes = 5 * 60 * 1000;
          
          if (cached && cachedTime && (Date.now() - parseInt(cachedTime)) < fiveMinutes) {
            try {
              window.__PRELOADED_SETTINGS__ = JSON.parse(cached);
              // Update title, description and favicon immediately if cached
              const settings = JSON.parse(cached);
              if (settings.store_name) {
                document.title = settings.store_name;
              }
              if (settings.store_logo) {
                updateFavicon(settings.store_logo);
              }
              if (settings.store_description) {
                updateMetaDescription(settings.store_description);
              }
            } catch (e) {
              // Ignore parse errors
            }
          }
          
          // Fetch fresh settings in background
          fetch(API_URL + '/settings')
            .then(res => res.json())
            .then(data => {
              if (data.success && data.data) {
                window.__PRELOADED_SETTINGS__ = data.data;
                // Cache for 5 minutes
                localStorage.setItem(settingsKey, JSON.stringify(data.data));
                localStorage.setItem(settingsKey + '_timestamp', Date.now().toString());
                
                // Update title, description and favicon if available
                if (data.data.store_name) {
                  document.title = data.data.store_name;
                }
                if (data.data.store_logo) {
                  updateFavicon(data.data.store_logo);
                }
                if (data.data.store_description) {
                  updateMetaDescription(data.data.store_description);
                }
              }
            })
            .catch(() => {
              // Silently fail - React will handle it
            });
        })();
      </script>
    </head>

    <body>
      <div id="root"></div>
      <script type="module" src="/src/main.tsx"></script>
    </body>
  </html>
  